#+TITLE: SAEB
#+AUTHOR: Matheus Serpa
#+STARTUP: overview indent
#+TAGS: noexport(n) deprecated(d)
#+EXPORT_SELECT_TAGS: export
#+EXPORT_EXCLUDE_TAGS: noexport
#+SEQ_TODO: TODO(t!) STARTED(s!) WAITING(w!) | DONE(d!) CANCELLED(c!) DEFERRED(f!)
* professor 

#+begin_src R :results output :session *R* :exports both
library(dplyr)
library(readr)
library(tidyr)

dfPROFESSOR <- read_csv("./TS_PROFESSOR.csv") %>% as.data.frame

#nrow(dfPROFESSOR)
#head(dfPROFESSOR)
#+end_src


#+begin_src R :results output :session *R* :exports both
library(dplyr)
library(readr)
library(tidyr)

dfPROFESSOR <- subset(dfPROFESSOR, IN_PREENCHIMENTO_QUESTIONARIO != 0)
dfPROFESSOR$IN_PREENCHIMENTO_QUESTIONARIO <- NULL

dfPROFESSOR$ID_PROVA_BRASIL <- NULL

dfPROFESSOR$ID_UF <- NULL

dfPROFESSOR <- dfPROFESSOR %>% left_join(dfMUNICIPIO) %>% filter(!is.na(MUNICIPIO))
dfPROFESSOR$ID_MUNICIPIO <- NULL

dfPROFESSOR$ID_DEPENDENCIA_ADM <- NULL

dfPROFESSOR$ID_LOCALIZACAO <- NULL

dfPROFESSOR$CO_PROFESSOR <- NULL

#ID_TURMA left(ALUNO,PROFESSOR)

dfPROFESSOR$ID_SERIE <- NULL

dfPROFESSOR$TX_RESP_Q001 <- NULL

dfPROFESSOR$TX_RESP_Q003 <- NULL

dfPROFESSOR$TX_RESP_Q005 <- NULL
dfPROFESSOR$TX_RESP_Q006 <- NULL
dfPROFESSOR$TX_RESP_Q007 <- NULL

dfPROFESSOR$TX_RESP_Q009 <- NULL
dfPROFESSOR$TX_RESP_Q010 <- NULL
dfPROFESSOR$TX_RESP_Q011 <- NULL
dfPROFESSOR$TX_RESP_Q012 <- NULL

dfPROFESSOR$TX_RESP_Q014 <- NULL
dfPROFESSOR$TX_RESP_Q015 <- NULL
dfPROFESSOR$TX_RESP_Q016 <- NULL
dfPROFESSOR$TX_RESP_Q017 <- NULL
dfPROFESSOR$TX_RESP_Q018 <- NULL
dfPROFESSOR$TX_RESP_Q019 <- NULL
dfPROFESSOR$TX_RESP_Q020 <- NULL
dfPROFESSOR$TX_RESP_Q021 <- NULL
dfPROFESSOR$TX_RESP_Q022 <- NULL
dfPROFESSOR$TX_RESP_Q023 <- NULL
dfPROFESSOR$TX_RESP_Q024 <- NULL
dfPROFESSOR$TX_RESP_Q025 <- NULL
dfPROFESSOR$TX_RESP_Q026 <- NULL
dfPROFESSOR$TX_RESP_Q027 <- NULL
dfPROFESSOR$TX_RESP_Q028 <- NULL
dfPROFESSOR$TX_RESP_Q029 <- NULL
dfPROFESSOR$TX_RESP_Q030 <- NULL
dfPROFESSOR$TX_RESP_Q031 <- NULL
dfPROFESSOR$TX_RESP_Q032 <- NULL
dfPROFESSOR$TX_RESP_Q033 <- NULL
dfPROFESSOR$TX_RESP_Q034 <- NULL
dfPROFESSOR$TX_RESP_Q035 <- NULL
dfPROFESSOR$TX_RESP_Q036 <- NULL
dfPROFESSOR$TX_RESP_Q037 <- NULL
dfPROFESSOR$TX_RESP_Q038 <- NULL
dfPROFESSOR$TX_RESP_Q039 <- NULL
dfPROFESSOR$TX_RESP_Q040 <- NULL
dfPROFESSOR$TX_RESP_Q041 <- NULL
dfPROFESSOR$TX_RESP_Q042 <- NULL
dfPROFESSOR$TX_RESP_Q043 <- NULL
dfPROFESSOR$TX_RESP_Q044 <- NULL
dfPROFESSOR$TX_RESP_Q045 <- NULL
dfPROFESSOR$TX_RESP_Q046 <- NULL
dfPROFESSOR$TX_RESP_Q047 <- NULL
dfPROFESSOR$TX_RESP_Q048 <- NULL
dfPROFESSOR$TX_RESP_Q049 <- NULL
dfPROFESSOR$TX_RESP_Q050 <- NULL
dfPROFESSOR$TX_RESP_Q051 <- NULL
dfPROFESSOR$TX_RESP_Q052 <- NULL
dfPROFESSOR$TX_RESP_Q053 <- NULL
dfPROFESSOR$TX_RESP_Q054 <- NULL
dfPROFESSOR$TX_RESP_Q055 <- NULL
dfPROFESSOR$TX_RESP_Q056 <- NULL
dfPROFESSOR$TX_RESP_Q057 <- NULL
dfPROFESSOR$TX_RESP_Q058 <- NULL
dfPROFESSOR$TX_RESP_Q059 <- NULL
dfPROFESSOR$TX_RESP_Q060 <- NULL
dfPROFESSOR$TX_RESP_Q061 <- NULL
dfPROFESSOR$TX_RESP_Q062 <- NULL
dfPROFESSOR$TX_RESP_Q063 <- NULL
dfPROFESSOR$TX_RESP_Q064 <- NULL
dfPROFESSOR$TX_RESP_Q065 <- NULL
dfPROFESSOR$TX_RESP_Q066 <- NULL
dfPROFESSOR$TX_RESP_Q067 <- NULL
dfPROFESSOR$TX_RESP_Q068 <- NULL
dfPROFESSOR$TX_RESP_Q069 <- NULL
dfPROFESSOR$TX_RESP_Q070 <- NULL
dfPROFESSOR$TX_RESP_Q071 <- NULL
dfPROFESSOR$TX_RESP_Q072 <- NULL
dfPROFESSOR$TX_RESP_Q073 <- NULL
dfPROFESSOR$TX_RESP_Q074 <- NULL
dfPROFESSOR$TX_RESP_Q075 <- NULL
dfPROFESSOR$TX_RESP_Q076 <- NULL
dfPROFESSOR$TX_RESP_Q077 <- NULL
dfPROFESSOR$TX_RESP_Q078 <- NULL
dfPROFESSOR$TX_RESP_Q079 <- NULL
dfPROFESSOR$TX_RESP_Q080 <- NULL
dfPROFESSOR$TX_RESP_Q081 <- NULL
dfPROFESSOR$TX_RESP_Q082 <- NULL
dfPROFESSOR$TX_RESP_Q083 <- NULL
dfPROFESSOR$TX_RESP_Q084 <- NULL
dfPROFESSOR$TX_RESP_Q085 <- NULL
dfPROFESSOR$TX_RESP_Q086 <- NULL
dfPROFESSOR$TX_RESP_Q087 <- NULL
dfPROFESSOR$TX_RESP_Q088 <- NULL
dfPROFESSOR$TX_RESP_Q089 <- NULL
dfPROFESSOR$TX_RESP_Q090 <- NULL
dfPROFESSOR$TX_RESP_Q091 <- NULL
dfPROFESSOR$TX_RESP_Q092 <- NULL
dfPROFESSOR$TX_RESP_Q093 <- NULL
dfPROFESSOR$TX_RESP_Q094 <- NULL
dfPROFESSOR$TX_RESP_Q095 <- NULL
dfPROFESSOR$TX_RESP_Q096 <- NULL
dfPROFESSOR$TX_RESP_Q097 <- NULL
dfPROFESSOR$TX_RESP_Q098 <- NULL
dfPROFESSOR$TX_RESP_Q099 <- NULL
dfPROFESSOR$TX_RESP_Q0100 <- NULL
dfPROFESSOR$TX_RESP_Q0101 <- NULL
dfPROFESSOR$TX_RESP_Q0102 <- NULL
dfPROFESSOR$TX_RESP_Q0103 <- NULL
dfPROFESSOR$TX_RESP_Q0104 <- NULL

dfPROFESSOR$TX_RESP_Q0106 <- NULL
dfPROFESSOR$TX_RESP_Q0107 <- NULL
dfPROFESSOR$TX_RESP_Q0108 <- NULL
dfPROFESSOR$TX_RESP_Q0109 <- NULL
dfPROFESSOR$TX_RESP_Q0110 <- NULL
dfPROFESSOR$TX_RESP_Q0111 <- NULL
dfPROFESSOR$TX_RESP_Q0112 <- NULL
dfPROFESSOR$TX_RESP_Q0113 <- NULL
dfPROFESSOR$TX_RESP_Q0114 <- NULL
dfPROFESSOR$TX_RESP_Q0115 <- NULL
dfPROFESSOR$TX_RESP_Q0116 <- NULL
dfPROFESSOR$TX_RESP_Q0117 <- NULL
dfPROFESSOR$TX_RESP_Q0118 <- NULL
dfPROFESSOR$TX_RESP_Q0119 <- NULL
dfPROFESSOR$TX_RESP_Q0120 <- NULL
dfPROFESSOR$TX_RESP_Q0121 <- NULL
dfPROFESSOR$TX_RESP_Q0122 <- NULL
dfPROFESSOR$TX_RESP_Q0123 <- NULL
dfPROFESSOR$TX_RESP_Q0124 <- NULL
dfPROFESSOR$TX_RESP_Q0125 <- NULL

names(dfPROFESSOR) <- paste("PROFESSOR", names(dfPROFESSOR), sep = "_")

dfPROFESSORPT <- subset(dfPROFESSOR, PROFESSOR_TX_RESP_Q105 == "A" | PROFESSOR_TX_RESP_Q105 == "C")
dfPROFESSORMT <- subset(dfPROFESSOR, PROFESSOR_TX_RESP_Q105 == "B" | PROFESSOR_TX_RESP_Q105 == "C")

#head(dfPROFESSOR)
#head(dfPROFESSORPT)
#head(dfPROFESSORMT)

rm("dfPROFESSOR")
#+end_src

* diretor 

#+begin_src R :results output :session *R* :exports both
library(dplyr)
library(readr)
library(tidyr)

dfDIRETOR <- read_csv("./TS_DIRETOR.csv") %>% as.data.frame

#nrow(dfDIRETORBKP)
#head(dfDIRETORBKP)
#+end_src

#+begin_src R :results output :session *R* :exports both
library(dplyr)
library(readr)
library(tidyr)

dfDIRETOR <- subset(dfDIRETOR, IN_PREENCHIMENTO_QUESTIONARIO != 0)
dfDIRETOR$IN_PREENCHIMENTO_QUESTIONARIO <- NULL

dfDIRETOR$ID_PROVA_BRASIL <- NULL

dfDIRETOR$ID_UF <- NULL

dfDIRETOR$ID_MUNICIPIO <- NULL

#ID_ESCOLA left(ESCOLA,DIRETOR)

dfDIRETOR$ID_DEPENDENCIA_ADM <- NULL

dfDIRETOR$ID_LOCALIZACAO <- NULL

dfDIRETOR$TX_RESP_Q001 <- NULL
dfDIRETOR$TX_RESP_Q002 <- NULL
dfDIRETOR$TX_RESP_Q003 <- NULL
dfDIRETOR$TX_RESP_Q004 <- NULL
dfDIRETOR$TX_RESP_Q005 <- NULL
dfDIRETOR$TX_RESP_Q006 <- NULL
dfDIRETOR$TX_RESP_Q007 <- NULL
dfDIRETOR$TX_RESP_Q008 <- NULL
dfDIRETOR$TX_RESP_Q009 <- NULL
dfDIRETOR$TX_RESP_Q010 <- NULL
dfDIRETOR$TX_RESP_Q011 <- NULL
dfDIRETOR$TX_RESP_Q012 <- NULL
dfDIRETOR$TX_RESP_Q013 <- NULL
dfDIRETOR$TX_RESP_Q014 <- NULL
dfDIRETOR$TX_RESP_Q015 <- NULL
dfDIRETOR$TX_RESP_Q016 <- NULL
dfDIRETOR$TX_RESP_Q017 <- NULL
dfDIRETOR$TX_RESP_Q018 <- NULL
dfDIRETOR$TX_RESP_Q019 <- NULL
dfDIRETOR$TX_RESP_Q020 <- NULL
dfDIRETOR$TX_RESP_Q021 <- NULL
dfDIRETOR$TX_RESP_Q022 <- NULL
dfDIRETOR$TX_RESP_Q023 <- NULL
dfDIRETOR$TX_RESP_Q024 <- NULL
dfDIRETOR$TX_RESP_Q025 <- NULL
dfDIRETOR$TX_RESP_Q026 <- NULL
dfDIRETOR$TX_RESP_Q027 <- NULL
dfDIRETOR$TX_RESP_Q028 <- NULL
dfDIRETOR$TX_RESP_Q029 <- NULL
dfDIRETOR$TX_RESP_Q030 <- NULL
dfDIRETOR$TX_RESP_Q031 <- NULL
dfDIRETOR$TX_RESP_Q032 <- NULL
dfDIRETOR$TX_RESP_Q033 <- NULL
dfDIRETOR$TX_RESP_Q034 <- NULL
dfDIRETOR$TX_RESP_Q035 <- NULL
dfDIRETOR$TX_RESP_Q036 <- NULL
dfDIRETOR$TX_RESP_Q037 <- NULL

dfDIRETOR$TX_RESP_Q039 <- NULL
dfDIRETOR$TX_RESP_Q040 <- NULL
dfDIRETOR$TX_RESP_Q041 <- NULL
dfDIRETOR$TX_RESP_Q042 <- NULL
dfDIRETOR$TX_RESP_Q043 <- NULL
dfDIRETOR$TX_RESP_Q044 <- NULL
dfDIRETOR$TX_RESP_Q045 <- NULL
dfDIRETOR$TX_RESP_Q046 <- NULL
dfDIRETOR$TX_RESP_Q047 <- NULL
dfDIRETOR$TX_RESP_Q048 <- NULL
dfDIRETOR$TX_RESP_Q049 <- NULL
dfDIRETOR$TX_RESP_Q050 <- NULL
dfDIRETOR$TX_RESP_Q051 <- NULL
dfDIRETOR$TX_RESP_Q052 <- NULL
dfDIRETOR$TX_RESP_Q053 <- NULL
dfDIRETOR$TX_RESP_Q054 <- NULL
dfDIRETOR$TX_RESP_Q055 <- NULL
dfDIRETOR$TX_RESP_Q056 <- NULL
dfDIRETOR$TX_RESP_Q057 <- NULL
dfDIRETOR$TX_RESP_Q058 <- NULL
dfDIRETOR$TX_RESP_Q059 <- NULL
dfDIRETOR$TX_RESP_Q060 <- NULL
dfDIRETOR$TX_RESP_Q061 <- NULL
dfDIRETOR$TX_RESP_Q062 <- NULL
dfDIRETOR$TX_RESP_Q063 <- NULL
dfDIRETOR$TX_RESP_Q064 <- NULL
dfDIRETOR$TX_RESP_Q065 <- NULL
dfDIRETOR$TX_RESP_Q066 <- NULL
dfDIRETOR$TX_RESP_Q067 <- NULL

dfDIRETOR$TX_RESP_Q069 <- NULL
dfDIRETOR$TX_RESP_Q070 <- NULL
dfDIRETOR$TX_RESP_Q071 <- NULL
dfDIRETOR$TX_RESP_Q072 <- NULL
dfDIRETOR$TX_RESP_Q073 <- NULL
dfDIRETOR$TX_RESP_Q074 <- NULL
dfDIRETOR$TX_RESP_Q075 <- NULL
dfDIRETOR$TX_RESP_Q076 <- NULL
dfDIRETOR$TX_RESP_Q077 <- NULL
dfDIRETOR$TX_RESP_Q078 <- NULL
dfDIRETOR$TX_RESP_Q079 <- NULL
dfDIRETOR$TX_RESP_Q080 <- NULL
dfDIRETOR$TX_RESP_Q081 <- NULL
dfDIRETOR$TX_RESP_Q082 <- NULL
dfDIRETOR$TX_RESP_Q083 <- NULL
dfDIRETOR$TX_RESP_Q084 <- NULL
dfDIRETOR$TX_RESP_Q085 <- NULL
dfDIRETOR$TX_RESP_Q086 <- NULL
dfDIRETOR$TX_RESP_Q087 <- NULL
dfDIRETOR$TX_RESP_Q088 <- NULL
dfDIRETOR$TX_RESP_Q089 <- NULL
dfDIRETOR$TX_RESP_Q090 <- NULL
dfDIRETOR$TX_RESP_Q091 <- NULL
dfDIRETOR$TX_RESP_Q092 <- NULL
dfDIRETOR$TX_RESP_Q093 <- NULL
dfDIRETOR$TX_RESP_Q094 <- NULL
dfDIRETOR$TX_RESP_Q095 <- NULL
dfDIRETOR$TX_RESP_Q096 <- NULL
dfDIRETOR$TX_RESP_Q097 <- NULL


dfDIRETOR$TX_RESP_Q100 <- NULL
dfDIRETOR$TX_RESP_Q101 <- NULL
dfDIRETOR$TX_RESP_Q102 <- NULL
dfDIRETOR$TX_RESP_Q103 <- NULL
dfDIRETOR$TX_RESP_Q104 <- NULL
dfDIRETOR$TX_RESP_Q105 <- NULL
dfDIRETOR$TX_RESP_Q106 <- NULL
dfDIRETOR$TX_RESP_Q107 <- NULL
dfDIRETOR$TX_RESP_Q108 <- NULL
dfDIRETOR$TX_RESP_Q109 <- NULL
dfDIRETOR$TX_RESP_Q110 <- NULL
dfDIRETOR$TX_RESP_Q111 <- NULL

names(dfDIRETOR) <- paste("DIRETOR", names(dfDIRETOR), sep = "_")

#head(dfDIRETOR)
#+end_src

* escola 

#+begin_src R :results output :session *R* :exports both
library(dplyr)
library(readr)
library(tidyr)

dfESCOLA <- read_csv("./TS_ESCOLA.csv") %>% as.data.frame

#nrow(dfESCOLA)
#head(dfESCOLA)
#+end_src

#+begin_src R :results output :session *R* :exports both
library(dplyr)
library(readr)
library(tidyr)

dfESCOLA <- subset(dfESCOLA, IN_PREENCHIMENTO_QUESTIONARIO != 0)
dfESCOLA$IN_PREENCHIMENTO_QUESTIONARIO <- NULL

dfESCOLA$ID_PROVA_BRASIL <- NULL

dfESCOLA$UF <- ifelse(dfESCOLA$ID_UF == 11, "RO",
               ifelse(dfESCOLA$ID_UF == 12, "AC",
               ifelse(dfESCOLA$ID_UF == 13, "AM",
               ifelse(dfESCOLA$ID_UF == 14, "RR",
               ifelse(dfESCOLA$ID_UF == 15, "PA",
               ifelse(dfESCOLA$ID_UF == 16, "AP",
               ifelse(dfESCOLA$ID_UF == 17, "TO",
               ifelse(dfESCOLA$ID_UF == 21, "MA",
               ifelse(dfESCOLA$ID_UF == 22, "PI",
               ifelse(dfESCOLA$ID_UF == 23, "CE",
               ifelse(dfESCOLA$ID_UF == 24, "RN",
               ifelse(dfESCOLA$ID_UF == 25, "PB",
               ifelse(dfESCOLA$ID_UF == 26, "PE",
               ifelse(dfESCOLA$ID_UF == 27, "AL",
               ifelse(dfESCOLA$ID_UF == 28, "SE",
               ifelse(dfESCOLA$ID_UF == 29, "BA",
               ifelse(dfESCOLA$ID_UF == 31, "MG",
               ifelse(dfESCOLA$ID_UF == 32, "ES",
               ifelse(dfESCOLA$ID_UF == 33, "RJ",
               ifelse(dfESCOLA$ID_UF == 35, "SP",
               ifelse(dfESCOLA$ID_UF == 41, "PR",
               ifelse(dfESCOLA$ID_UF == 42, "SC",
               ifelse(dfESCOLA$ID_UF == 43, "RS",
               ifelse(dfESCOLA$ID_UF == 50, "MS",
               ifelse(dfESCOLA$ID_UF == 51, "MT",
               ifelse(dfESCOLA$ID_UF == 52, "GO",
               ifelse(dfESCOLA$ID_UF == 53, "DF", "NA")))))))))))))))))))))))))))
dfESCOLA$ID_UF <- NULL

#dfESCOLA <- dfESCOLA %>% left_join(dfMUNICIPIO) %>% filter(!is.na(MUNICIPIO))
dfESCOLA$ID_MUNICIPIO <- NULL

#ID_ESCOLA left(ESCOLA, DIRETOR)

dfESCOLA <- subset(dfESCOLA, ID_DEPENDENCIA_ADM != 1)

#dfESCOLA$DEPENDENCIA_ADM <- ifelse(dfESCOLA$ID_DEPENDENCIA_ADM == 1, "Federal", 
#                            ifelse(dfESCOLA$ID_DEPENDENCIA_ADM == 2, "Estadual", 
#                            ifelse(dfESCOLA$ID_DEPENDENCIA_ADM == 3, "Municipal", 
#                            ifelse(dfESCOLA$ID_DEPENDENCIA_ADM == 4, "Privada", "NA"))))
dfESCOLA$DEPENDENCIA_ADM <- ifelse(dfESCOLA$ID_DEPENDENCIA_ADM == 2, 1, 
                            ifelse(dfESCOLA$ID_DEPENDENCIA_ADM == 3, 1, 
                            ifelse(dfESCOLA$ID_DEPENDENCIA_ADM == 4, 0, "NA")))
dfESCOLA$ID_DEPENDENCIA_ADM <- NULL

#dfESCOLA$LOCALIZACAO <- ifelse(dfESCOLA$ID_LOCALIZACAO == 1, "Urbana", 
#                        ifelse(dfESCOLA$ID_LOCALIZACAO == 2, "Rural", "NA"))
dfESCOLA$LOCALIZACAO <- ifelse(dfESCOLA$ID_LOCALIZACAO == 1, 1, 
                        ifelse(dfESCOLA$ID_LOCALIZACAO == 2, 0, "NA"))
dfESCOLA$ID_LOCALIZACAO <- NULL

dfESCOLA$PC_FORMACAO_DOCENTE_INICIAL <- NULL
dfESCOLA$PC_FORMACAO_DOCENTE_FINAL <- NULL
dfESCOLA$NU_MATRICULADOS_CENSO_5EF <- NULL
dfESCOLA$NU_PRESENTES_5EF <- NULL
dfESCOLA$TAXA_PARTICIPACAO_5EF <- NULL
dfESCOLA$Nivel_0_LP5 <- NULL
dfESCOLA$Nivel_1_LP5 <- NULL
dfESCOLA$Nivel_2_LP5 <- NULL
dfESCOLA$Nivel_3_LP5 <- NULL
dfESCOLA$Nivel_4_LP5 <- NULL
dfESCOLA$Nivel_5_LP5 <- NULL
dfESCOLA$Nivel_6_LP5 <- NULL
dfESCOLA$Nivel_7_LP5 <- NULL
dfESCOLA$Nivel_8_LP5 <- NULL
dfESCOLA$Nivel_9_LP5 <- NULL
dfESCOLA$Nivel_0_MT5 <- NULL
dfESCOLA$Nivel_1_MT5 <- NULL
dfESCOLA$Nivel_2_MT5 <- NULL
dfESCOLA$Nivel_3_MT5 <- NULL
dfESCOLA$Nivel_4_MT5 <- NULL
dfESCOLA$Nivel_5_MT5 <- NULL
dfESCOLA$Nivel_6_MT5 <- NULL
dfESCOLA$Nivel_7_MT5 <- NULL
dfESCOLA$Nivel_8_MT5 <- NULL
dfESCOLA$Nivel_9_MT5 <- NULL
dfESCOLA$Nivel_10_MT5 <- NULL
dfESCOLA$NU_MATRICULADOS_CENSO_9EF <- NULL
dfESCOLA$NU_PRESENTES_9EF <- NULL
dfESCOLA$TAXA_PARTICIPACAO_9EF <- NULL
dfESCOLA$Nivel_0_LP9 <- NULL
dfESCOLA$Nivel_1_LP9 <- NULL
dfESCOLA$Nivel_2_LP9 <- NULL
dfESCOLA$Nivel_3_LP9 <- NULL
dfESCOLA$Nivel_4_LP9 <- NULL
dfESCOLA$Nivel_5_LP9 <- NULL
dfESCOLA$Nivel_6_LP9 <- NULL
dfESCOLA$Nivel_7_LP9 <- NULL
dfESCOLA$Nivel_8_LP9 <- NULL
dfESCOLA$Nivel_0_MT9 <- NULL
dfESCOLA$Nivel_1_MT9 <- NULL
dfESCOLA$Nivel_2_MT9 <- NULL
dfESCOLA$Nivel_3_MT9 <- NULL
dfESCOLA$Nivel_4_MT9 <- NULL
dfESCOLA$Nivel_5_MT9 <- NULL
dfESCOLA$Nivel_6_MT9 <- NULL
dfESCOLA$Nivel_7_MT9 <- NULL
dfESCOLA$Nivel_8_MT9 <- NULL
dfESCOLA$Nivel_9_MT9 <- NULL
dfESCOLA$MEDIA_5EF_LP <- NULL
dfESCOLA$MEDIA_5EF_MT <- NULL
dfESCOLA$MEDIA_9EF_LP <- NULL
dfESCOLA$MEDIA_9EF_MT <- NULL

dfESCOLA$TX_RESP_Q001 <- NULL
dfESCOLA$TX_RESP_Q002 <- NULL
dfESCOLA$TX_RESP_Q003 <- NULL
dfESCOLA$TX_RESP_Q004 <- NULL
dfESCOLA$TX_RESP_Q005 <- NULL
dfESCOLA$TX_RESP_Q006 <- NULL
dfESCOLA$TX_RESP_Q007 <- NULL
dfESCOLA$TX_RESP_Q008 <- NULL
dfESCOLA$TX_RESP_Q009 <- NULL
dfESCOLA$TX_RESP_Q010 <- NULL
dfESCOLA$TX_RESP_Q011 <- NULL
dfESCOLA$TX_RESP_Q012 <- NULL
dfESCOLA$TX_RESP_Q013 <- NULL
dfESCOLA$TX_RESP_Q014 <- NULL
dfESCOLA$TX_RESP_Q015 <- NULL
dfESCOLA$TX_RESP_Q016 <- NULL
dfESCOLA$TX_RESP_Q017 <- NULL
dfESCOLA$TX_RESP_Q018 <- NULL
dfESCOLA$TX_RESP_Q019 <- NULL
dfESCOLA$TX_RESP_Q020 <- NULL
dfESCOLA$TX_RESP_Q021 <- NULL
dfESCOLA$TX_RESP_Q022 <- NULL
dfESCOLA$TX_RESP_Q023 <- NULL
dfESCOLA$TX_RESP_Q024 <- NULL
dfESCOLA$TX_RESP_Q025 <- NULL
dfESCOLA$TX_RESP_Q026 <- NULL
dfESCOLA$TX_RESP_Q027 <- NULL
dfESCOLA$TX_RESP_Q028 <- NULL
dfESCOLA$TX_RESP_Q029 <- NULL
dfESCOLA$TX_RESP_Q030 <- NULL
dfESCOLA$TX_RESP_Q031 <- NULL
dfESCOLA$TX_RESP_Q032 <- NULL
dfESCOLA$TX_RESP_Q033 <- NULL
dfESCOLA$TX_RESP_Q034 <- NULL
dfESCOLA$TX_RESP_Q035 <- NULL
dfESCOLA$TX_RESP_Q036 <- NULL


dfESCOLA$TX_RESP_Q039 <- NULL
dfESCOLA$TX_RESP_Q040 <- NULL
dfESCOLA$TX_RESP_Q041 <- NULL
dfESCOLA$TX_RESP_Q042 <- NULL
dfESCOLA$TX_RESP_Q043 <- NULL
dfESCOLA$TX_RESP_Q044 <- NULL
dfESCOLA$TX_RESP_Q045 <- NULL
dfESCOLA$TX_RESP_Q046 <- NULL
dfESCOLA$TX_RESP_Q047 <- NULL
dfESCOLA$TX_RESP_Q048 <- NULL
dfESCOLA$TX_RESP_Q049 <- NULL
dfESCOLA$TX_RESP_Q050 <- NULL
dfESCOLA$TX_RESP_Q051 <- NULL
dfESCOLA$TX_RESP_Q052 <- NULL
dfESCOLA$TX_RESP_Q053 <- NULL
dfESCOLA$TX_RESP_Q054 <- NULL
dfESCOLA$TX_RESP_Q055 <- NULL
dfESCOLA$TX_RESP_Q056 <- NULL
dfESCOLA$TX_RESP_Q057 <- NULL
dfESCOLA$TX_RESP_Q058 <- NULL
dfESCOLA$TX_RESP_Q059 <- NULL
dfESCOLA$TX_RESP_Q060 <- NULL
dfESCOLA$TX_RESP_Q061 <- NULL
dfESCOLA$TX_RESP_Q062 <- NULL
dfESCOLA$TX_RESP_Q063 <- NULL
dfESCOLA$TX_RESP_Q064 <- NULL
dfESCOLA$TX_RESP_Q065 <- NULL
dfESCOLA$TX_RESP_Q066 <- NULL
dfESCOLA$TX_RESP_Q067 <- NULL
dfESCOLA$TX_RESP_Q068 <- NULL
dfESCOLA$TX_RESP_Q069 <- NULL
dfESCOLA$TX_RESP_Q070 <- NULL
dfESCOLA$TX_RESP_Q071 <- NULL

dfESCOLA$TX_RESP_Q073 <- NULL
dfESCOLA$TX_RESP_Q074 <- NULL

names(dfESCOLA) <- paste("ESCOLA", names(dfESCOLA), sep = "_")

dfESCOLA <- left_join(dfESCOLA, dfDIRETOR, by = c("ESCOLA_ID_ESCOLA"="DIRETOR_ID_ESCOLA")) %>%  filter(!is.na(DIRETOR_UF))
#dfESCOLA$DIRETOR_UF <- NULL
#dfESCOLA$ESCOLA_ID_ESCOLA <- NULL
#dfESCOLA$DIRETOR_ID_ESCOLA <- NULL
#head(dfDIRETOR)
#head(dfESCOLA)
#+end_src

* aluno 

#+begin_src R :results output :session *R* :exports both
library(dplyr)
library(readr)
library(tidyr)

dfALUNO <- read_csv("./TS_ALUNO_5EF.csv") %>% as.data.frame

#nrow(dfALUNO)
#head(dfALUNO)
#+end_src


#+begin_src R :results output :session *R* :exports both
library(dplyr)
library(readr)
library(tidyr)
library(stringr)

dfALUNO <- subset(dfALUNO, IN_PREENCHIMENTO_QUESTIONARIO != 0)
dfALUNO$IN_PREENCHIMENTO_QUESTIONARIO <- NULL

dfALUNO <- subset(dfALUNO, IN_PREENCHIMENTO_PROVA != 0)
dfALUNO$IN_PREENCHIMENTO_PROVA <- NULL

dfALUNO <- subset(dfALUNO, IN_PROFICIENCIA != 0)
dfALUNO$IN_PROFICIENCIA <- NULL

dfALUNO$ID_PROVA_BRASIL <- NULL
dfALUNO$ID_REGIAO <- NULL

dfALUNO$UF <- ifelse(dfALUNO$ID_UF == 11, "RO",
              ifelse(dfALUNO$ID_UF == 12, "AC",
              ifelse(dfALUNO$ID_UF == 13, "AM",
              ifelse(dfALUNO$ID_UF == 14, "RR",
              ifelse(dfALUNO$ID_UF == 15, "PA",
              ifelse(dfALUNO$ID_UF == 16, "AP",
              ifelse(dfALUNO$ID_UF == 17, "TO",
              ifelse(dfALUNO$ID_UF == 21, "MA",
              ifelse(dfALUNO$ID_UF == 22, "PI",
              ifelse(dfALUNO$ID_UF == 23, "CE",
              ifelse(dfALUNO$ID_UF == 24, "RN",
              ifelse(dfALUNO$ID_UF == 25, "PB",
              ifelse(dfALUNO$ID_UF == 26, "PE",
              ifelse(dfALUNO$ID_UF == 27, "AL",
              ifelse(dfALUNO$ID_UF == 28, "SE",
              ifelse(dfALUNO$ID_UF == 29, "BA",
              ifelse(dfALUNO$ID_UF == 31, "MG",
              ifelse(dfALUNO$ID_UF == 32, "ES",
              ifelse(dfALUNO$ID_UF == 33, "RJ",
              ifelse(dfALUNO$ID_UF == 35, "SP",
              ifelse(dfALUNO$ID_UF == 41, "PR",
              ifelse(dfALUNO$ID_UF == 42, "SC",
              ifelse(dfALUNO$ID_UF == 43, "RS",
              ifelse(dfALUNO$ID_UF == 50, "MS",
              ifelse(dfALUNO$ID_UF == 51, "MT",
              ifelse(dfALUNO$ID_UF == 52, "GO",
              ifelse(dfALUNO$ID_UF == 53, "DF", "NA")))))))))))))))))))))))))))
dfALUNO$ID_UF <- NULL

dfALUNO$ID_MUNICIPIO <- NULL

dfALUNO$AREA <- ifelse(dfALUNO$ID_AREA == 1, "Capital", 
                ifelse(dfALUNO$ID_AREA == 2, "Interior", "NA"))
dfALUNO$ID_AREA <- NULL

#ID_ESCOLA left(ALUNO,ESCOLA)

dfALUNO$ID_DEPENDENCIA_ADM <- NULL

#dfALUNO$LOCALIZACAO <- ifelse(dfALUNO$ID_LOCALIZACAO == 1, "Urbana", 
#                       ifelse(dfALUNO$ID_LOCALIZACAO == 2, "Rural", "NA"))
dfALUNO$LOCALIZACAO <- ifelse(dfALUNO$ID_LOCALIZACAO == 1, 1, 
                       ifelse(dfALUNO$ID_LOCALIZACAO == 2, 0, "NA"))
dfALUNO$ID_LOCALIZACAO <- NULL

#ID_TURMA left(ALUNO,PROFESSOR)

dfALUNO$ID_TURNO <- NULL
dfALUNO$ID_SERIE <- NULL
#dfALUNO$ID_ALUNO <- NULL
dfALUNO$IN_SITUACAO_CENSO <- NULL
dfALUNO$ID_CADERNO <- NULL
dfALUNO$ID_BLOCO_1 <- NULL
dfALUNO$ID_BLOCO_2 <- NULL
dfALUNO$TX_RESP_BLOCO_1_LP <- NULL
dfALUNO$TX_RESP_BLOCO_2_LP <- NULL
dfALUNO$TX_RESP_BLOCO_1_MT <- NULL
dfALUNO$TX_RESP_BLOCO_2_MT <- NULL
dfALUNO$IN_PROVA_BRASIL <- NULL
dfALUNO$ESTRATO_ANEB <- NULL



dfALUNO$TX_RESP_Q003 <- NULL
dfALUNO$TX_RESP_Q004 <- NULL









dfALUNO$TX_RESP_Q014 <- NULL
dfALUNO$TX_RESP_Q015 <- NULL
dfALUNO$TX_RESP_Q016 <- NULL
dfALUNO$TX_RESP_Q017 <- NULL
dfALUNO$TX_RESP_Q018 <- NULL

dfALUNO$TX_RESP_Q020 <- NULL
dfALUNO$TX_RESP_Q021 <- NULL
dfALUNO$TX_RESP_Q022 <- NULL

dfALUNO$TX_RESP_Q024 <- NULL
dfALUNO$TX_RESP_Q025 <- NULL
dfALUNO$TX_RESP_Q026 <- NULL
dfALUNO$TX_RESP_Q027 <- NULL
dfALUNO$TX_RESP_Q028 <- NULL
dfALUNO$TX_RESP_Q029 <- NULL
dfALUNO$TX_RESP_Q030 <- NULL
dfALUNO$TX_RESP_Q031 <- NULL
dfALUNO$TX_RESP_Q032 <- NULL
dfALUNO$TX_RESP_Q033 <- NULL
dfALUNO$TX_RESP_Q034 <- NULL
dfALUNO$TX_RESP_Q035 <- NULL
dfALUNO$TX_RESP_Q036 <- NULL
dfALUNO$TX_RESP_Q037 <- NULL
dfALUNO$TX_RESP_Q038 <- NULL
dfALUNO$TX_RESP_Q039 <- NULL
dfALUNO$TX_RESP_Q040 <- NULL
dfALUNO$TX_RESP_Q041 <- NULL
dfALUNO$TX_RESP_Q042 <- NULL
dfALUNO$TX_RESP_Q043 <- NULL
dfALUNO$TX_RESP_Q044 <- NULL
dfALUNO$TX_RESP_Q045 <- NULL
dfALUNO$TX_RESP_Q046 <- NULL
dfALUNO$TX_RESP_Q047 <- NULL
dfALUNO$TX_RESP_Q048 <- NULL
dfALUNO$TX_RESP_Q049 <- NULL
dfALUNO$TX_RESP_Q050 <- NULL
dfALUNO$TX_RESP_Q051 <- NULL

names(dfALUNO) <- paste("ALUNO", names(dfALUNO), sep = "_")

#head(dfESCOLA)
dfALUNO <- left_join(dfALUNO, dfESCOLA, by = c("ALUNO_ID_ESCOLA"="ESCOLA_ID_ESCOLA")) %>%  filter(!is.na(ESCOLA_UF))
#dfALUNO$ESCOLA_UF <- NULL
#dfALUNO$ALUNO_ID_ESCOLA <- NULL
#head(dfALUNO)

names(dfALUNO) <- str_replace(names(dfALUNO), "TX_RESP_Q", "Q")
names(dfPROFESSORPT) <- str_replace(names(dfPROFESSORPT), "TX_RESP_Q", "Q")
names(dfPROFESSORMT) <- str_replace(names(dfPROFESSORMT), "TX_RESP_Q", "Q")

#if(FALSE){
# begin luana

dfALUNO$ESCOLA_Q37 <- ifelse(dfALUNO$ESCOLA_Q037 == "D", 0, ifelse(dfALUNO$ESCOLA_Q037 == "C", 1, ifelse(dfALUNO$ESCOLA_Q037 == "B", 1, ifelse(dfALUNO$ESCOLA_Q037 == "A", 1, NA))))

dfALUNO$ESCOLA_Q38 <- ifelse(dfALUNO$ESCOLA_Q038 == "D", 0, ifelse(dfALUNO$ESCOLA_Q038 == "C", 1, ifelse(dfALUNO$ESCOLA_Q038 == "B", 1, ifelse(dfALUNO$ESCOLA_Q038 == "A", 1, NA))))

dfALUNO$ESCOLA_Q72 <- ifelse(dfALUNO$ESCOLA_Q072 == "D", 0, ifelse(dfALUNO$ESCOLA_Q072 == "C", 0, ifelse(dfALUNO$ESCOLA_Q072 == "B", 0, ifelse(dfALUNO$ESCOLA_Q072 == "A", 1, NA))))

dfALUNO$ALUNO_Q5 <- ifelse(dfALUNO$ALUNO_Q005 == "A", 0, ifelse(dfALUNO$ALUNO_Q005 == "B", 1, ifelse(dfALUNO$ALUNO_Q005 == "C", 1, ifelse(dfALUNO$ALUNO_Q005 == "D", 1, ifelse(dfALUNO$ALUNO_Q05 == "E", 1, NA)))))

dfALUNO$ALUNO_Q6 <- ifelse(dfALUNO$ALUNO_Q006 == "A", 0, ifelse(dfALUNO$ALUNO_Q006 == "B", 1, ifelse(dfALUNO$ALUNO_Q006 == "C", 1, ifelse(dfALUNO$ALUNO_Q006 == "D", 1, ifelse(dfALUNO$ALUNO_Q06 == "E", 1, NA)))))

dfALUNO$ALUNO_Q7 <- ifelse(dfALUNO$ALUNO_Q007 == "A", 0, ifelse(dfALUNO$ALUNO_Q007 == "B", 1, ifelse(dfALUNO$ALUNO_Q007 == "C", 1, ifelse(dfALUNO$ALUNO_Q007 == "D", 1, ifelse(dfALUNO$ALUNO_Q07 == "E", 1, NA)))))

dfALUNO$ALUNO_Q8 <- ifelse(dfALUNO$ALUNO_Q008 == "A", 0, ifelse(dfALUNO$ALUNO_Q008 == "B", 1, ifelse(dfALUNO$ALUNO_Q008 == "C", 1, ifelse(dfALUNO$ALUNO_Q008 == "D", 1, ifelse(dfALUNO$ALUNO_Q08 == "E", 1, NA)))))

dfALUNO$ALUNO_Q9 <- ifelse(dfALUNO$ALUNO_Q009 == "A", 0, ifelse(dfALUNO$ALUNO_Q009 == "B", 1, ifelse(dfALUNO$ALUNO_Q009 == "C", 1, ifelse(dfALUNO$ALUNO_Q009 == "D", 1, ifelse(dfALUNO$ALUNO_Q09 == "E", 1, NA)))))

dfALUNO$ALUNO_Q10 <- ifelse(dfALUNO$ALUNO_Q010 == "A", 0, ifelse(dfALUNO$ALUNO_Q010 == "B", 1, ifelse(dfALUNO$ALUNO_Q010 == "C", 1, ifelse(dfALUNO$ALUNO_Q010 == "D", 1, ifelse(dfALUNO$ALUNO_Q010 == "E", 1, NA)))))

dfALUNO$ALUNO_Q11 <- ifelse(dfALUNO$ALUNO_Q011 == "A", 0, ifelse(dfALUNO$ALUNO_Q011 == "B", 1, ifelse(dfALUNO$ALUNO_Q011 == "C", 1, ifelse(dfALUNO$ALUNO_Q011 == "D", 1, ifelse(dfALUNO$ALUNO_Q011 == "E", 1, NA)))))

dfALUNO$ALUNO_Q12 <- ifelse(dfALUNO$ALUNO_Q012 == "A", 0, ifelse(dfALUNO$ALUNO_Q012 == "B", 1, ifelse(dfALUNO$ALUNO_Q012 == "C", 1, ifelse(dfALUNO$ALUNO_Q012 == "D", 1, ifelse(dfALUNO$ALUNO_Q012 == "E", 1, NA)))))

dfALUNO$ALUNO_Q13 <- ifelse(dfALUNO$ALUNO_Q013 == "A", 0, ifelse(dfALUNO$ALUNO_Q013 == "B", 1, ifelse(dfALUNO$ALUNO_Q013 == "C", 1, ifelse(dfALUNO$ALUNO_Q013 == "D", 1, ifelse(dfALUNO$ALUNO_Q013 == "E", 1, NA)))))

dfALUNO$DIRETOR_Q98 <- ifelse(dfALUNO$DIRETOR_Q098 == "B", 0, ifelse(dfALUNO$DIRETOR_Q098 == "A", 1, NA))

dfALUNO$DIRETOR_Q99 <- ifelse(dfALUNO$DIRETOR_Q099 == "B", 0, ifelse(dfALUNO$DIRETOR_Q099 == "A", 1, NA))

dfALUNO$DIRETOR_Q38 <- ifelse(dfALUNO$DIRETOR_Q038 == "A", 0, ifelse(dfALUNO$DIRETOR_Q038 == "B", 0, ifelse(dfALUNO$DIRETOR_Q038 == "C", 1, ifelse(dfALUNO$DIRETOR_Q038 == "D", 1, NA))))

dfALUNO$DIRETOR_Q68 <- ifelse(dfALUNO$DIRETOR_Q068 == "A", 0, ifelse(dfALUNO$DIRETOR_Q068 == "B", 1, ifelse(dfALUNO$DIRETOR_Q068 == "C", 1, ifelse(dfALUNO$DIRETOR_Q068 == "D", 1, NA))))

dfALUNO$ALUNO_Q1 <- ifelse(dfALUNO$ALUNO_Q001 == "A", 1, ifelse(dfALUNO$ALUNO_Q001 == "B", 0, NA))

dfALUNO$ALUNO_Q2 <- ifelse(dfALUNO$ALUNO_Q002 == "A", 1, ifelse(dfALUNO$ALUNO_Q002 == "B", 0, ifelse(dfALUNO$ALUNO_Q002 == "C", 0, ifelse(dfALUNO$ALUNO_Q002 == "D", 1, ifelse(dfALUNO$ALUNO_Q02 == "E", 0, NA)))))

dfALUNO <- subset(dfALUNO, ALUNO_Q2 = 0 | ALUNO_Q2 = 1)

dfALUNO$ALUNO_Q19 <- ifelse(dfALUNO$ALUNO_Q019 == "A", 1, ifelse(dfALUNO$ALUNO_Q019 == "B", 1, ifelse(dfALUNO$ALUNO_Q019 == "C", 2, ifelse(dfALUNO$ALUNO_Q019 == "D", 2, ifelse(dfALUNO$ALUNO_Q019 == "E", 3, ifelse(dfALUNO$ALUNO_Q019 == "F", 4, NA))))))

dfALUNO$ALUNO_Q23 <- ifelse(dfALUNO$ALUNO_Q023 == "A", 1, ifelse(dfALUNO$ALUNO_Q023 == "B", 1, ifelse(dfALUNO$ALUNO_Q023 == "C", 2, ifelse(dfALUNO$ALUNO_Q023 == "D", 2, ifelse(dfALUNO$ALUNO_Q023 == "E", 3, ifelse(dfALUNO$ALUNO_Q023 == "F", 4, NA))))))

#esc pai e mae
dfALUNO <- subset(dfALUNO, ALUNO_Q19 != -1)
dfALUNO <- subset(dfALUNO, ALUNO_Q23 != -1)

dfPROFESSORMT$PROFESSOR_Q2 <- ifelse(dfPROFESSORMT$PROFESSOR_Q002 == "A", 1, ifelse(dfPROFESSORMT$PROFESSOR_Q002 == "B", 2, ifelse(dfPROFESSORMT$PROFESSOR_Q002 == "C", 2, ifelse(dfPROFESSORMT$PROFESSOR_Q002 == "D", 3, ifelse(dfPROFESSORMT$PROFESSOR_Q002 == "E", 3, ifelse(dfPROFESSORMT$PROFESSOR_Q002 == "F", 4, NA))))))

dfPROFESSORMT$PROFESSOR_Q13 <- ifelse(dfPROFESSORMT$PROFESSOR_Q013 == "A", 1, ifelse(dfPROFESSORMT$PROFESSOR_Q013 == "B", 1, ifelse(dfPROFESSORMT$PROFESSOR_Q013 == "C", 2, ifelse(dfPROFESSORMT$PROFESSOR_Q013 == "D", 2, ifelse(dfPROFESSORMT$PROFESSOR_Q013 == "E", 3, ifelse(dfPROFESSORMT$PROFESSOR_Q013 == "F", 3, ifelse(dfPROFESSORMT$PROFESSOR_Q013 == "G", 4, NA)))))))

dfPROFESSORMT$PROFESSOR_Q4 <- ifelse(dfPROFESSORMT$PROFESSOR_Q004 == "A", 1, ifelse(dfPROFESSORMT$PROFESSOR_Q004 == "B", 2, ifelse(dfPROFESSORMT$PROFESSOR_Q004 == "C", 2, ifelse(dfPROFESSORMT$PROFESSOR_Q004 == "D", 3, ifelse(dfPROFESSORMT$PROFESSOR_Q004 == "E", 3, ifelse(dfPROFESSORMT$PROFESSOR_Q004 == "F", 3, ifelse(dfPROFESSORMT$PROFESSOR_Q004 == "G", 3, ifelse(dfPROFESSORMT$PROFESSOR_Q004 == "H", 3, ifelse(dfPROFESSORMT$PROFESSOR_Q004 == "I", 3, NA)))))))))

dfPROFESSORMT$PROFESSOR_Q8 <- ifelse(dfPROFESSORMT$PROFESSOR_Q008 == "A", 0, ifelse(dfPROFESSORMT$PROFESSOR_Q008 == "B", 4, ifelse(dfPROFESSORMT$PROFESSOR_Q008 == "C", 5, ifelse(dfPROFESSORMT$PROFESSOR_Q008 == "D", 6, ifelse(dfPROFESSORMT$PROFESSOR_Q008 == "E", 6, NA)))))

dfPROFESSORMT$PROFESSOR_ESCPROF <- max(dfPROFESSORMT$PROFESSOR_Q004, dfPROFESSORMT$PROFESSOR_Q008)

#dfPROFESSORPT$PROFESSOR_Q107 <- ifelse(dfPROFESSORPT$PROFESSOR_Q107 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q107 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q107 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q107 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q107 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q107 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q108 <- ifelse(dfPROFESSORPT$PROFESSOR_Q108 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q108 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q108 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q108 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q108 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q108 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q109 <- ifelse(dfPROFESSORPT$PROFESSOR_Q109 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q109 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q109 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q109 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q109 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q109 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q110 <- ifelse(dfPROFESSORPT$PROFESSOR_Q110 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q110 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q110 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q110 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q110 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q110 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q111 <- ifelse(dfPROFESSORPT$PROFESSOR_Q111 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q111 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q111 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q111 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q111 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q111 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q112 <- ifelse(dfPROFESSORPT$PROFESSOR_Q112 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q112 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q112 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q112 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q112 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q112 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q113 <- ifelse(dfPROFESSORPT$PROFESSOR_Q113 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q113 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q113 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q113 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q113 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q113 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q114 <- ifelse(dfPROFESSORPT$PROFESSOR_Q114 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q114 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q114 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q114 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q114 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q114 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q115 <- ifelse(dfPROFESSORPT$PROFESSOR_Q115 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q115 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q115 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q115 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q115 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q115 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q116 <- ifelse(dfPROFESSORPT$PROFESSOR_Q116 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q116 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q116 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q116 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q116 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q116 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q117 <- ifelse(dfPROFESSORPT$PROFESSOR_Q117 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q117 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q117 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q117 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q117 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q117 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q118 <- ifelse(dfPROFESSORPT$PROFESSOR_Q118 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q118 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q118 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q118 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q118 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q118 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q119 <- ifelse(dfPROFESSORPT$PROFESSOR_Q119 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q119 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q119 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q119 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q119 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q119 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q120 <- ifelse(dfPROFESSORPT$PROFESSOR_Q120 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q120 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q120 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q120 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q120 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q120 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q121 <- ifelse(dfPROFESSORPT$PROFESSOR_Q121 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q121 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q121 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q121 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q121 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q121 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q122 <- ifelse(dfPROFESSORPT$PROFESSOR_Q122 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q122 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q122 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q122 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q122 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q122 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q123 <- ifelse(dfPROFESSORPT$PROFESSOR_Q123 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q123 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q123 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q123 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q123 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q123 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q124 <- ifelse(dfPROFESSORPT$PROFESSOR_Q124 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q124 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q124 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q124 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q124 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q124 == "F", 5, "NA"))))))

#dfPROFESSORPT$PROFESSOR_Q125 <- ifelse(dfPROFESSORPT$PROFESSOR_Q125 == "A", 0, ifelse(dfPROFESSORPT$PROFESSOR_Q125 == "B", 1, ifelse(dfPROFESSORPT$PROFESSOR_Q125 == "C", 2, ifelse(dfPROFESSORPT$PROFESSOR_Q125 == "D", 3, ifelse(dfPROFESSORPT$PROFESSOR_Q125 == "E", 4, ifelse(dfPROFESSORPT$PROFESSOR_Q125 == "F", 5, "NA"))))))
# end luana
#}

#dfALUNOMasc <- subset(dfALUNO, ALUNO_Q001 == "A")
#dfALUNOFem  <- subset(dfALUNO, ALUNO_Q001 == "B")

#dfALUNOMasc$ALUNO_Q001 <- NULL
#dfALUNOFem$ALUNO_Q001 <- NULL
#head(dfALUNO)
#head(dfALUNO)
#head(dfALUNOMasc)
#head(dfALUNOFem)

dfALUNOPT <- left_join(dfALUNO, dfPROFESSORPT, by = c("ALUNO_ID_TURMA"="PROFESSOR_ID_TURMA")) %>%  filter(!is.na(PROFESSOR_UF))
dfALUNOMT <- left_join(dfALUNO, dfPROFESSORMT, by = c("ALUNO_ID_TURMA"="PROFESSOR_ID_TURMA")) %>%  filter(!is.na(PROFESSOR_UF))

#dfALUNOMascPT <- left_join(dfALUNOMasc, dfPROFESSORPT, by = c("ALUNO_ID_TURMA"="PROFESSOR_ID_TURMA")) %>%  filter(!is.na(PROFESSOR_UF))
#dfALUNOMascPT$ALUNO_ID_TURMA <- NULL
#dfALUNOMascPT$PROFESSOR_UF <- NULL

#dfALUNOMascMT <- left_join(dfALUNOMasc, dfPROFESSORMT, by = c("ALUNO_ID_TURMA"="PROFESSOR_ID_TURMA")) %>%  filter(!is.na(PROFESSOR_UF))
#dfALUNOMascMT$ALUNO_ID_TURMA <- NULL
#dfALUNOMascMT$PROFESSOR_UF <- NULL

#dfALUNOFemPT <- left_join(dfALUNOFem, dfPROFESSORPT, by = c("ALUNO_ID_TURMA"="PROFESSOR_ID_TURMA")) %>%  filter(!is.na(PROFESSOR_UF))
#dfALUNOFemPT$ALUNO_ID_TURMA <- NULL
#dfALUNOFemPT$PROFESSOR_UF <- NULL

#dfALUNOFemMT <- left_join(dfALUNOFem, dfPROFESSORMT, by = c("ALUNO_ID_TURMA"="PROFESSOR_ID_TURMA")) %>%  filter(!is.na(PROFESSOR_UF))
#dfALUNOFemMT$ALUNO_ID_TURMA <- NULL
#dfALUNOFemMT$PROFESSOR_UF <- NULL

#head(dfALUNOMascPT)
#head(dfALUNOMascMT)
#head(dfALUNOFemPT)
#head(dfALUNOFemMT)
head(dfALUNOPT)
head(dfALUNOMT)

#write.csv(file="dfALUNOMascPT.csv", dfALUNOMascPT, row.names=FALSE, na="")
#write.csv(file="dfALUNOMascMT.csv", dfALUNOMascMT, row.names=FALSE, na="")
#write.csv(file="dfALUNOFemPT.csv", dfALUNOFemPT, row.names=FALSE, na="")
#write.csv(file="dfALUNOFemMT.csv", dfALUNOFemMT, row.names=FALSE, na="")

write.csv(file="dfALUNOPT.csv", dfALUNOPT, row.names=FALSE, na="")                                                                write.csv(file="dfALUNOMT.csv", dfALUNOMT, row.names=FALSE, na="")                                                                                                                               

#+end_src